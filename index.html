<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loter√≠a DRG - Comprobador Local</title>
    
    <!-- Estilos Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React y ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel para traducir el c√≥digo en el navegador -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { font-family: system-ui, -apple-system, sans-serif; }
        /* Animaciones simples */
        @keyframes bounce { 0%, 100% { transform: translateY(-25%); animation-timing-function: cubic-bezier(0.8,0,1,1); } 50% { transform: translateY(0); animation-timing-function: cubic-bezier(0,0,0.2,1); } }
        .animate-bounce { animation: bounce 1s infinite; }
        
        /* Clase para el efecto de brillo dorado */
        .gold-gradient {
            background: linear-gradient(135deg, #fbbf24 0%, #d97706 50%, #fbbf24 100%);
            -webkit-background-clip: text;
            background-clip: text;
        }
    </style>
</head>
<body class="bg-emerald-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ICONOS SVG (Inline para evitar dependencias externas) ---
        const Icon = ({ path, size = 24, className = "", viewBox = "0 0 24 24" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox={viewBox} fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} dangerouslySetInnerHTML={{ __html: path }} />
        );

        const Icons = {
            Plus: (props) => <Icon path='<path d="M5 12h14"/><path d="M12 5v14"/>' {...props} />,
            Trash2: (props) => <Icon path='<path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/>' {...props} />,
            Ticket: (props) => <Icon path='<path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="M13 5v2"/><path d="M13 17v2"/><path d="M13 11v2"/>' {...props} />,
            CheckCircle2: (props) => <Icon path='<circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/>' {...props} />,
            Gift: (props) => <Icon path='<rect x="3" y="8" width="18" height="4" rx="1"/><path d="M12 8v13"/><path d="M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7"/><path d="M7.5 8a2.5 2.5 0 0 1 0-5C10 3 12 6 12 6s2-3 4.5-3a2.5 2.5 0 0 1 0 5"/>' {...props} />,
            RefreshCw: (props) => <Icon path='<path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/>' {...props} />,
            X: (props) => <Icon path='<path d="M18 6 6 18"/><path d="m6 6 12 12"/>' {...props} />,
            Coins: (props) => <Icon path='<circle cx="8" cy="8" r="6"/><path d="M18.09 10.37A6 6 0 1 1 10.34 18"/><path d="M7 6h1v4"/><path d="m7.1 13.84 1.59-1.59"/>' {...props} />,
            Sparkles: (props) => <Icon path='<path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275Z"/>' {...props} />,
            Save: (props) => <Icon path='<path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/>' {...props} />,
            Share: (props) => <Icon path='<circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" x2="15.42" y1="13.51" y2="17.49"/><line x1="15.41" x2="8.59" y1="6.51" y2="10.49"/>' {...props} />,
            Download: (props) => <Icon path='<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/>' {...props} />,
            
            // Nuevo Drag√≥n Her√°ldico (Dise√±o vectorial complejo de respaldo)
            DragonEmblem: (props) => <Icon viewBox="0 0 100 100" strokeWidth="0" className="fill-current" path='<path d="M36.8,17.4c2.2,2.8,4.7,6.3,4.4,9.4c-0.2,2.4-2.1,3.9-3.9,5.2c-2.3,1.7-4.8,3.2-7.1,5c-4.4,3.4-8.1,7.8-10.4,12.9 c-1.5,3.4-2.3,7.1-2.1,10.8c0.2,4.8,2.7,9.3,6.5,12.1c3.5,2.6,7.9,3.7,12.2,3.4c6.3-0.4,12.1-3.6,16.5-8.1c3.9-4,7-8.8,10.2-13.4 c2.7-3.9,5.4-7.8,8.8-11.1c2.4-2.3,5.2-4.2,8.4-5.2c4.1-1.3,8.7-0.7,12.4,1.8c2.4,1.6,4.3,4,5.3,6.7c0.6,1.7,0.8,3.6,0.5,5.4 c-0.6,3.4-3.1,6.1-5.9,7.9c-3.6,2.3-7.9,3.1-12.1,3.1c-2.5,0-5-0.3-7.4-1.1c-0.6-0.2-1.2-0.3-1.8-0.2c-0.9,0.2-1.5,1.1-1.3,2 c0.2,0.9,1.1,1.5,2,1.3c3.4,1.1,7.1,1.4,10.7,1.1c5.1-0.4,10.1-2.2,14-5.5c2.9-2.5,4.9-6,5.3-9.8c0.3-2.9-0.5-5.9-2.3-8.2 c-2.2-2.9-5.6-4.7-9.2-5.3c-4.7-0.8-9.6,0.6-13.5,3.3c-3.2,2.2-5.7,5.4-7.8,8.7c-3.1,4.9-5.8,10.1-9.6,14.5 c-3.9,4.5-8.9,8-14.8,9.1c-4.1,0.8-8.5,0.1-12.2-2.1c-4.1-2.4-6.9-6.6-7.3-11.3c-0.3-3.8,1.2-7.5,3.6-10.5 c4.1-5.1,10.1-8.5,16.2-10.9c4.2-1.7,8.6-3,12.6-5.4c1.9-1.1,3.7-2.7,4.3-4.9c0.7-2.5-0.5-5.3-2.6-6.8c-2.6-1.9-6.1-1.8-8.8-0.3 c-2.4,1.3-4.3,3.4-5.8,5.7c-0.5,0.7-1.4,0.9-2.2,0.4c-0.7-0.5-0.9-1.4-0.4-2.2c1.9-3,4.5-5.5,7.7-6.9C30.6,9.2,34.8,11,36.8,17.4z M50,5c24.8,0,45,20.2,45,45S74.8,95,50,95S5,74.8,5,50S25.2,5,50,5z M50,11C28.5,11,11,28.5,11,50s17.5,39,39,39 s39-17.5,39-39S71.5,11,50,11z"/>' {...props} />
        };

        const LogoHeader = () => {
            const [imgError, setImgError] = useState(false);
            
            // Intentamos cargar 'logo_dragon.png' por defecto
            // Si falla, mostramos el SVG DragonEmblem
            
            return (
                <div className="flex items-center gap-4 relative z-10">
                    <div className="w-16 h-16 md:w-20 md:h-20 bg-gradient-to-br from-red-900 to-red-950 rounded-full border-2 border-yellow-500 shadow-xl flex items-center justify-center overflow-hidden relative group">
                        {/* Brillo del logo */}
                        <div className="absolute inset-0 bg-yellow-400 opacity-10 group-hover:opacity-20 transition-opacity"></div>
                        
                        {!imgError ? (
                            <img 
                                src="logo_dragon.png" 
                                alt="Drag√≥n DRG" 
                                className="w-full h-full object-cover"
                                onError={() => setImgError(true)}
                            />
                        ) : (
                            <Icons.DragonEmblem size={48} className="text-yellow-400 drop-shadow-lg" />
                        )}
                    </div>
                    
                    <div className="flex flex-col">
                        <h1 className="text-3xl md:text-5xl font-serif font-black tracking-wider text-transparent bg-clip-text bg-gradient-to-b from-yellow-200 to-yellow-500 drop-shadow-sm uppercase" style={{ textShadow: '2px 2px 4px rgba(0,0,0,0.3)' }}>
                          Loter√≠a DRG
                        </h1>
                        <div className="flex items-center gap-2">
                             <div className="h-0.5 w-8 bg-yellow-500/50"></div>
                             <p className="text-red-200 text-xs md:text-sm font-medium tracking-widest uppercase">
                                Sorteo Extraordinario
                             </p>
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
          // --- ESTADOS ---
          const [tickets, setTickets] = useState(() => {
            const saved = localStorage.getItem('loteria_tickets_local');
            return saved ? JSON.parse(saved) : [];
          });

          const [newTicketNumber, setNewTicketNumber] = useState('');
          const [newTicketAmount, setNewTicketAmount] = useState('');
          const [newTicketNote, setNewTicketNote] = useState('');

          const [checkNumber, setCheckNumber] = useState('');
          const [prizeType, setPrizeType] = useState('gordo');
          
          const [lastResult, setLastResult] = useState(null);
          const [isModalOpen, setIsModalOpen] = useState(false);

          // --- PREMIOS ---
          const PRIZE_VALUES = {
            'gordo': { name: 'El Gordo (1¬∫ Premio)', multiplier: 20000 },
            'segundo': { name: 'Segundo Premio', multiplier: 6250 },
            'tercero': { name: 'Tercer Premio', multiplier: 2500 },
            'cuarto': { name: 'Cuarto Premio', multiplier: 1000 },
            'quinto': { name: 'Quinto Premio', multiplier: 300 },
            'pedrea': { name: 'Pedrea / Menor', multiplier: 5 }
          };

          // --- EFECTO: CARGA INICIAL Y URL M√ÅGICA ---
          useEffect(() => {
            localStorage.setItem('loteria_tickets_local', JSON.stringify(tickets));
          }, [tickets]);

          useEffect(() => {
             const params = new URLSearchParams(window.location.search);
             const sharedData = params.get('data');
             if (sharedData) {
                 try {
                     const decoded = decodeURIComponent(escape(atob(sharedData)));
                     const json = JSON.parse(decoded);
                     if (Array.isArray(json) && json.length > 0) {
                         setTimeout(() => {
                            if(confirm(`¬°Hola! Hemos detectado una lista compartida con ${json.length} d√©cimos.\n\n¬øQuieres cargarla en este dispositivo?`)) {
                                setTickets(json);
                                alert("¬°D√©cimos cargados correctamente!");
                                window.history.replaceState({}, document.title, window.location.pathname);
                            }
                         }, 500);
                     }
                 } catch (e) {
                     console.error("Error cargando datos compartidos", e);
                 }
             }
          }, []);

          // --- FUNCIONES ---
          const addTicket = (e) => {
            e.preventDefault();
            if (newTicketNumber.length < 5) {
                alert("El n√∫mero debe tener 5 cifras (ej: 00123).");
                return;
            }
            const newTicket = {
              id: Date.now(),
              number: newTicketNumber,
              amount: newTicketAmount || 20,
              note: newTicketNote
            };
            setTickets([...tickets, newTicket]);
            setNewTicketNumber('');
            setNewTicketAmount('');
            setNewTicketNote('');
          };

          const removeTicket = (id) => {
            if (!confirm("¬øBorrar este d√©cimo?")) return;
            setTickets(tickets.filter(t => t.id !== id));
          };

          const handleNumberInput = (value, setter) => {
            const numericValue = value.replace(/[^0-9]/g, '').slice(0, 5);
            setter(numericValue);
          };

          const formatMoney = (amount) => {
            return new Intl.NumberFormat('es-ES', { style: 'currency', currency: 'EUR' }).format(amount);
          };

          const handleShareLink = () => {
              if (tickets.length === 0) {
                  alert("No tienes d√©cimos para compartir. A√±ade alguno primero.");
                  return;
              }
              const dataStr = JSON.stringify(tickets);
              const encoded = btoa(unescape(encodeURIComponent(dataStr))); 
              const fullUrl = `${window.location.origin}${window.location.pathname}?data=${encoded}`;
              
              navigator.clipboard.writeText(fullUrl).then(() => {
                  alert("‚úÖ ¬°ENLACE COPIADO!\n\nP√©galo en WhatsApp, Telegram o Email.\nQuien lo abra ver√° tus mismos d√©cimos.");
              }).catch(() => {
                  prompt("Copia este enlace y m√°ndalo por WhatsApp:", fullUrl);
              });
          };

          const calculateResults = (winningNumber, typeOfPrize) => {
            const selectedPrize = PRIZE_VALUES[typeOfPrize];
            const multiplier = selectedPrize.multiplier;

            const exactMatches = tickets
              .filter(t => t.number === winningNumber)
              .map(t => ({ ...t, prizeAmount: t.amount * multiplier }));

            const endingMatches = tickets.filter(t => 
              t.number !== winningNumber && 
              t.number.slice(-2) === winningNumber.slice(-2)
            );

            const totalWon = exactMatches.reduce((acc, curr) => acc + curr.prizeAmount, 0);

            setLastResult({
              checkedNumber: winningNumber,
              prizeName: selectedPrize.name,
              prizeMultiplier: multiplier,
              exact: exactMatches,
              terminations: endingMatches,
              totalWon: totalWon,
              hasPrize: exactMatches.length > 0 || endingMatches.length > 0
            });
            setIsModalOpen(true);
          };

          const checkWinningNumber = (e) => {
            e.preventDefault();
            if (checkNumber.length < 5) return;
            calculateResults(checkNumber, prizeType);
          };

          const simulateDraw = () => {
            if (tickets.length === 0) {
                alert("A√±ade alg√∫n d√©cimo primero para poder jugar al simulacro.");
                return;
            }
            const randomTicket = tickets[Math.floor(Math.random() * tickets.length)];
            setCheckNumber(randomTicket.number);
            setPrizeType('gordo');
            calculateResults(randomTicket.number, 'gordo');
          };

          const totalInvested = tickets.reduce((acc, curr) => acc + Number(curr.amount), 0);

          // --- UI ---
          return (
            <div className="min-h-screen text-slate-800 font-sans pb-12">
              {/* Header */}
              <header className="bg-gradient-to-r from-red-800 to-red-900 text-white p-6 md:p-8 shadow-2xl border-b-8 border-yellow-500 relative overflow-hidden">
                
                {/* Fondo Decorativo Sutil */}
                <div className="absolute inset-0 opacity-10 pointer-events-none">
                    <Icons.DragonEmblem className="absolute -right-20 -top-20 w-96 h-96 text-yellow-500 transform rotate-12" />
                </div>

                <div className="max-w-4xl mx-auto flex flex-col md:flex-row items-center justify-between gap-6 relative z-10">
                  
                  {/* LOGO Y T√çTULO */}
                  <LogoHeader />

                  {/* Resumen */}
                  <div className="bg-black/20 p-4 rounded-xl backdrop-blur-sm border border-white/10 text-right min-w-[150px]">
                    <p className="text-yellow-400 font-bold text-2xl leading-none">{tickets.length}</p>
                    <p className="text-xs text-red-100 uppercase tracking-widest mb-1 opacity-70">D√©cimos</p>
                    <div className="h-px bg-white/20 w-full my-1"></div>
                    <p className="text-white font-mono text-sm">{totalInvested}‚Ç¨ <span className="text-[10px] opacity-60">JUGADOS</span></p>
                  </div>
                </div>
              </header>

              <main className="max-w-3xl mx-auto p-4 space-y-8 mt-6">
                
                {/* 1. A√±adir */}
                <section className="bg-white rounded-xl shadow-md overflow-hidden border border-emerald-100">
                  <div className="bg-slate-800 p-3 flex items-center gap-2 text-white">
                    <Icons.Ticket className="text-emerald-400" size={20} />
                    <h2 className="font-bold text-sm uppercase tracking-wider">Registrar D√©cimo</h2>
                  </div>
                  <div className="p-5">
                    <form onSubmit={addTicket} className="flex flex-col md:flex-row gap-4 items-end">
                      <div className="flex-1 w-full">
                        <label className="block text-xs font-bold text-gray-400 uppercase mb-1">N√∫mero</label>
                        <input
                          type="text"
                          value={newTicketNumber}
                          onChange={(e) => handleNumberInput(e.target.value, setNewTicketNumber)}
                          placeholder="00000"
                          className="w-full text-4xl font-mono font-bold tracking-[0.2em] text-center border-2 border-gray-100 rounded-lg p-3 focus:border-emerald-500 outline-none placeholder-gray-100 transition-all text-slate-700"
                          maxLength={5}
                        />
                      </div>
                      <div className="w-full md:w-28">
                        <label className="block text-xs font-bold text-gray-400 uppercase mb-1">Importe (‚Ç¨)</label>
                        <input
                          type="number"
                          value={newTicketAmount}
                          onChange={(e) => setNewTicketAmount(e.target.value)}
                          placeholder="20"
                          className="w-full border-2 border-gray-100 rounded-lg p-3 outline-none focus:border-emerald-500 font-bold text-center"
                        />
                      </div>
                      <div className="w-full md:w-1/3">
                        <label className="block text-xs font-bold text-gray-400 uppercase mb-1">Nota</label>
                        <input
                          type="text"
                          value={newTicketNote}
                          onChange={(e) => setNewTicketNote(e.target.value)}
                          placeholder="Ej: Del bar..."
                          className="w-full border-2 border-gray-100 rounded-lg p-3 outline-none focus:border-emerald-500"
                        />
                      </div>
                      <button 
                        type="submit"
                        disabled={newTicketNumber.length < 5}
                        className="w-full md:w-auto bg-emerald-600 hover:bg-emerald-700 disabled:opacity-50 text-white font-bold py-3.5 px-8 rounded-lg shadow-lg hover:shadow-xl transition-all flex items-center justify-center gap-2"
                      >
                        <Icons.Plus size={24} />
                      </button>
                    </form>
                  </div>
                </section>

                {/* 2. Comprobar */}
                <section className="bg-white rounded-xl shadow-xl border-2 border-yellow-400 relative overflow-hidden group">
                  <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-yellow-400 via-yellow-200 to-yellow-400"></div>
                  <div className="bg-red-800 p-4 flex items-center justify-between text-white relative z-10">
                    <div className="flex items-center gap-2">
                        <Icons.Gift className="text-yellow-300" size={24} />
                        <h2 className="font-bold text-lg uppercase tracking-wider">Comprobar Premio</h2>
                    </div>
                    <span className="text-[10px] bg-red-900/50 px-2 py-1 rounded text-red-200 border border-red-700">EN VIVO</span>
                  </div>
                  
                  <div className="p-8 relative z-10">
                    <p className="text-center text-gray-500 mb-6 text-sm">Introduce el n√∫mero que acaban de cantar los ni√±os de San Ildefonso:</p>
                    <form onSubmit={checkWinningNumber} className="flex flex-col md:flex-row gap-4 items-center justify-center">
                      <div className="relative">
                        <input
                          type="text"
                          value={checkNumber}
                          onChange={(e) => handleNumberInput(e.target.value, setCheckNumber)}
                          placeholder="00000"
                          className="w-64 text-5xl font-mono font-black tracking-widest text-center text-red-600 bg-red-50/50 border-4 border-red-100 rounded-xl p-4 focus:border-yellow-500 outline-none shadow-inner transition-colors"
                          maxLength={5}
                        />
                         <div className="absolute -top-3 left-4 px-2 bg-white text-xs font-bold text-red-400">N√öMERO</div>
                      </div>
                      
                      <div className="flex flex-col gap-3 w-full md:w-auto">
                         <select 
                            value={prizeType}
                            onChange={(e) => setPrizeType(e.target.value)}
                            className="p-3 rounded-lg border-2 border-gray-200 text-sm bg-white font-bold text-gray-700 focus:border-yellow-500 outline-none cursor-pointer hover:bg-gray-50"
                         >
                            <option value="gordo">üèÜ El Gordo (400.000‚Ç¨)</option>
                            <option value="segundo">ü•à 2¬∫ Premio (125.000‚Ç¨)</option>
                            <option value="tercero">ü•â 3¬∫ Premio (50.000‚Ç¨)</option>
                            <option value="cuarto">4¬∫ Premio (20.000‚Ç¨)</option>
                            <option value="quinto">5¬∫ Premio (6.000‚Ç¨)</option>
                            <option value="pedrea">üîπ Pedrea (100‚Ç¨)</option>
                         </select>
                        <button 
                          type="submit"
                          disabled={checkNumber.length < 5}
                          className="bg-gradient-to-r from-yellow-400 to-yellow-500 hover:from-yellow-500 hover:to-yellow-600 text-red-900 font-black text-lg py-3 px-8 rounded-lg shadow-lg hover:shadow-yellow-500/30 transform hover:-translate-y-0.5 active:translate-y-0 transition-all flex items-center justify-center gap-2"
                        >
                          <Icons.Coins size={24} /> ¬°COMPROBAR!
                        </button>
                      </div>
                    </form>

                     <div className="mt-8 text-center border-t border-dashed border-gray-200 pt-4">
                       <button 
                         onClick={simulateDraw}
                         className="text-xs text-emerald-600 hover:text-emerald-800 font-bold flex items-center justify-center gap-2 mx-auto hover:bg-emerald-50 px-4 py-2 rounded-full transition-colors group"
                       >
                         <Icons.Sparkles size={16} className="group-hover:animate-spin" /> 
                         <span>Modo Simulacro: <span className="font-normal opacity-80">Probar suerte (Demo)</span></span>
                       </button>
                    </div>
                  </div>
                </section>

                {/* 3. Lista */}
                <section>
                  <div className="flex items-center justify-between mb-4 px-2">
                    <h3 className="text-xl font-bold text-emerald-900 flex items-center gap-2">
                       <span className="w-2 h-8 bg-emerald-500 rounded-full"></span>
                       Tus D√©cimos Guardados
                    </h3>
                    {tickets.length > 0 && (
                        <span className="text-xs bg-white px-3 py-1 rounded-full border border-gray-200 text-gray-500 font-mono shadow-sm">
                            Total: {tickets.length}
                        </span>
                    )}
                  </div>

                  {tickets.length === 0 ? (
                    <div className="text-center py-16 bg-white rounded-xl border-2 border-dashed border-gray-300 text-gray-400">
                      <div className="flex justify-center mb-4 opacity-30"><Icons.Ticket size={64}/></div>
                      <p className="text-lg font-medium">Tu lista est√° vac√≠a</p>
                      <p className="text-sm opacity-70">A√±ade tus d√©cimos arriba para no perderlos de vista.</p>
                    </div>
                  ) : (
                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                      {tickets.map((ticket) => (
                        <div key={ticket.id} className="bg-white p-4 rounded-xl shadow-sm border border-gray-100 hover:shadow-md hover:border-emerald-200 transition-all group relative overflow-hidden">
                          <div className="absolute right-0 top-0 w-16 h-16 bg-emerald-50 rounded-bl-full -mr-8 -mt-8 transition-transform group-hover:scale-150"></div>
                          <div className="flex justify-between items-start relative z-10">
                            <div>
                              <span className="text-3xl font-mono font-bold text-slate-700 tracking-widest block group-hover:text-emerald-700 transition-colors">
                                {ticket.number}
                              </span>
                              <div className="flex items-center gap-2 mt-2">
                                 <span className="text-emerald-800 font-bold bg-emerald-100 px-2 py-0.5 rounded text-xs border border-emerald-200">{ticket.amount}‚Ç¨</span>
                                 {ticket.note && (
                                    <span className="text-gray-400 text-xs italic truncate max-w-[120px] flex items-center gap-1">
                                        ‚Ä¢ {ticket.note}
                                    </span>
                                 )}
                              </div>
                            </div>
                            <button 
                              onClick={() => removeTicket(ticket.id)}
                              className="text-gray-300 hover:text-red-500 hover:bg-red-50 p-2 rounded-full transition-all"
                              title="Borrar"
                            >
                              <Icons.Trash2 size={18} />
                            </button>
                          </div>
                        </div>
                      ))}
                    </div>
                  )}
                </section>
              </main>

              <footer className="text-center text-gray-500 text-xs py-12 bg-slate-50 border-t border-slate-200 mt-12">
                <p className="mb-4">Datos guardados localmente en tu navegador.</p>
                
                {/* BOT√ìN NUEVO: COMPARTIR ENLACE */}
                <div className="flex justify-center gap-4">
                    <button onClick={handleShareLink} className="flex items-center gap-2 text-white font-bold bg-slate-800 hover:bg-slate-900 px-6 py-3 rounded-full shadow-lg transition-transform active:scale-95">
                        <Icons.Share size={16} /> COMPARTIR LISTA
                    </button>
                </div>
                <p className="mt-3 text-[10px] text-gray-400">Genera un enlace seguro para enviar a otros dispositivos</p>
              </footer>

              {/* Modal */}
              {isModalOpen && lastResult && (
                <div className="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-in fade-in duration-300">
                  <div className="bg-white rounded-2xl shadow-2xl max-w-sm w-full overflow-hidden scale-100">
                    
                    <div className={`p-8 text-center ${lastResult.hasPrize ? 'bg-gradient-to-br from-yellow-300 to-yellow-500' : 'bg-slate-100'} relative`}>
                      <button onClick={() => setIsModalOpen(false)} className="absolute top-4 right-4 p-2 rounded-full bg-black/10 hover:bg-black/20 transition-colors">
                        <Icons.X size={20} />
                      </button>

                      {lastResult.hasPrize ? (
                        <>
                          <div className="text-6xl mb-4 animate-bounce">üéâ</div>
                          <h2 className="text-3xl font-black text-red-900 uppercase tracking-wide drop-shadow-sm leading-none mb-1">
                            ¬°PREMIO!
                          </h2>
                          <div className="bg-white/20 inline-block px-3 py-1 rounded-full mb-4">
                            <p className="text-red-900 font-bold text-sm tracking-wide">{lastResult.checkedNumber}</p>
                          </div>
                          
                           {lastResult.totalWon > 0 && (
                             <div className="bg-white/90 rounded-xl p-4 shadow-lg backdrop-blur transform rotate-1">
                                <span className="text-xs font-bold block text-slate-500 uppercase tracking-wider mb-1">Ganancia Total</span>
                                <span className="text-4xl font-mono font-black text-emerald-600 tracking-tight">{formatMoney(lastResult.totalWon)}</span>
                             </div>
                           )}
                        </>
                      ) : (
                        <>
                          <div className="text-6xl mb-4 grayscale opacity-50">üçÄ</div>
                          <h2 className="text-2xl font-bold text-slate-600">Sin suerte</h2>
                          <p className="text-slate-400 text-sm mt-2">El n√∫mero {lastResult.checkedNumber} no coincide.</p>
                        </>
                      )}
                    </div>

                    <div className="p-6 space-y-4 max-h-[50vh] overflow-y-auto bg-white">
                      
                      {lastResult.exact.length > 0 && (
                        <div className="bg-green-50 border border-green-100 rounded-xl p-4">
                          <h4 className="font-black text-green-800 text-xs uppercase tracking-wider flex items-center gap-2 mb-3">
                            <Icons.CheckCircle2 size={16} /> Premio Exacto
                          </h4>
                          <ul className="space-y-2">
                            {lastResult.exact.map(t => (
                              <li key={t.id} className="flex justify-between items-center bg-white p-3 rounded-lg border border-green-100 shadow-sm">
                                <div>
                                    <span className="font-mono font-bold text-xl block text-slate-700">{t.number}</span>
                                    {t.note && <span className="text-[10px] text-slate-400 uppercase">{t.note}</span>}
                                </div>
                                <span className="font-bold text-green-600 text-lg">{formatMoney(t.prizeAmount)}</span>
                              </li>
                            ))}
                          </ul>
                        </div>
                      )}

                      {lastResult.terminations.length > 0 && (
                        <div className="bg-yellow-50 border border-yellow-100 rounded-xl p-4">
                          <h4 className="font-black text-yellow-800 text-xs uppercase tracking-wider flex items-center gap-2 mb-2">
                            <Icons.RefreshCw size={16} /> Terminaci√≥n (..{lastResult.checkedNumber.slice(-2)})
                          </h4>
                          <p className="text-[10px] text-yellow-700 mb-3 opacity-80">Posible premio menor (reintegro, etc).</p>
                          <ul className="space-y-2">
                            {lastResult.terminations.map(t => (
                              <li key={t.id} className="flex justify-between px-3 py-2 text-sm text-slate-600 bg-white rounded border border-yellow-100 shadow-sm">
                                <span className="font-mono font-bold">{t.number}</span>
                                <span className="text-xs font-medium text-yellow-600 bg-yellow-100 px-2 py-0.5 rounded">Final</span>
                              </li>
                            ))}
                          </ul>
                        </div>
                      )}

                      <button 
                        onClick={() => setIsModalOpen(false)}
                        className="w-full bg-slate-900 hover:bg-black text-white font-bold py-4 rounded-xl transition-all shadow-lg active:scale-95"
                      >
                        Seguir Comprobando
                      </button>
                    </div>
                  </div>
                </div>
              )}
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
